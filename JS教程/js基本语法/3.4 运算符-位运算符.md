运算符-位运算符
===========

*《JavaScript 教程》作者：阮一峰*

**七个二进制运算符**

位运算符一共有7个:

- 按位或（or）：符号为 `|` ，表示若两个二进制位都为0，则结果为0，否则为1。
- 按位与（and）：符号为 `&` ，表示若两个二进制位都为1，则结果为1，否则为0。
- 按位取反（not）：符号为 `~` ，表示对一个二进制位取反。
- 异或运算符（xor）：符号为 `^` ，表示若两个二进制位不相同，则结果为1，否则为0。
- 左移运算符（left shift）：符号为 `<<` 。
- 右移运算符（right shift）：符号为 `>>` 。
- 头部补零的右移运算符（zero filled right shift）：符号为 `>>>` 。

这些位运算符直接处理每一个比特位（bit），所以是非常底层的运算，好处是速度极快，缺点是很不直观，许多场合不能使用它们，否则会使代码难以理解和查错。

**注意**

有一点需要特别注意，所有的位运算符只对整数起作用，如果一个运算子不是整数，会自动转为整数后再执行。另外，虽然在 JavaScript 内部，数值都是以64位浮点数的形式储存，但是做位运算的时候，是以32位带符号的整数进行运算的，并且返回值也是一个32位带符号的整数。

```JS
i = i | 0;
```
上面这行代码的意思，就是将i（不管是整数或小数）转为32位整数。

[详见 ->](https://wangdoc.com/javascript/operators/bit.html)

**按位或运算符 `|`**

可用于将一个小数取整:

```JS
0 | 3 // 3

2.9 | 0 // 2
-2.9 | 0 // -2

2147483649.4 | 0;
// -2147483647
```

需要注意的是，这种取整方法不适用超过32位整数最大值2147483647的数。

**按位取反运算符 `~`**

对一个小数连续进行两次二进制否运算，能达到取整效果。使用二进制否运算取整，是所有取整方法中最快的一种。

```JS
~~2.9 // 2
~~47.11 // 47
~~1.9999 // 1
~~3 // 3
```

对其他类型的值进行按位取反运算，JavaScript 引擎会先调用Number函数，将字符串转为数值，然后再进行处理。

**异或运算符 `^`**

“异或运算”有一个特殊运用，连续对两个数 a 和 b 进行三次异或运算，`a^=b; b^=a; a^=b`;，可以互换它们的值。这意味着，使用“异或运算”可以在不引入临时变量的前提下，互换两个变量的值。

这是互换两个变量的值的最快方法。

**左移运算符 `<<`**

左移运算符（<<）表示将一个数的二进制值向左移动指定的位数，尾部补0，即乘以2的指定次方

如果左移0位，就相当于将该数值转为32位整数，等同于取整，对于正数和负数都有效。

**右移运算符 `>>`**

右移运算符（>>）表示将一个数的二进制值向右移动指定的位数。如果是正数，头部全部补0；如果是负数，头部全部补1。右移运算符基本上相当于除以2的指定次方（最高位即符号位参与移动）。

右移运算可以模拟 2 的整除运算。

```JS
5 >> 1
// 2
// 相当于 5 / 2 = 2

21 >> 2
// 5
// 相当于 21 / 4 = 5

21 >> 3
// 2
// 相当于 21 / 8 = 2

21 >> 4
// 1
// 相当于 21 / 16 = 1
```

**头部补零的右移运算符 `>>>`**

头部补零的右移运算符（>>>）与右移运算符（>>）只有一个差别，就是一个数的二进制形式向右移动时，头部一律补零，而不考虑符号位。

对于正数，该运算的结果与右移运算符（>>）完全一致，区别主要在于负数。

查看一个负整数在计算机内部的储存形式，最快的方法就是使用这个运算符。

```JS
-1 >>> 0 // 4294967295
```
上面代码表示，-1作为32位整数时，内部的储存形式使用无符号整数格式解读，值为 4294967295（即(2^32)-1，等于11111111111111111111111111111111）。

**应用**

位运算符可以用作设置对象属性的开关。

假定某个对象有四个开关，每个开关都是一个变量。那么，可以设置一个四位的二进制数，它的每个位对应一个开关。

```JS
var FLAG_A = 1; // 0001
var FLAG_B = 2; // 0010
var FLAG_C = 4; // 0100
var FLAG_D = 8; // 1000
```