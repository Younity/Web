RegExp 对象
===========

*《JavaScript 教程》作者：阮一峰*

JavaScript 的正则表达式体系是参照 Perl 5 建立的。

新建正则表达式有两种方法。

一种是使用字面量，以斜杠表示开始和结束。如 `/xyz/`。

另一种是使用 RegExp 构造函数。RegExp构造函数还可以接受第二个参数，表示修饰符。

它们的主要区别是，第一种方法在引擎编译代码时，就会新建正则表达式，第二种方法在运行时新建正则表达式，所以前者的效率较高。而且，前者比较便利和直观，所以实际应用中，基本上都采用字面量定义正则表达式。

**实例属性**

分成两类，一类是修饰符相关，用于了解设置了什么修饰符。它们都是只读的:

`RegExp.prototype.ignoreCase`：返回一个布尔值，表示是否设置了 i 修饰符。

`RegExp.prototype.global`：返回一个布尔值，表示是否设置了 g 修饰符。

`RegExp.prototype.multiline`：返回一个布尔值，表示是否设置了 m 修饰符。

`RegExp.prototype.flags`：返回一个字符串，包含了已经设置的所有修饰符，按字母排序。

另一类是与修饰符无关的属性，主要是下面两个：

`RegExp.prototype.lastIndex`：返回一个整数，表示下一次开始搜索的位置。该属性可读写，但是只在进行连续搜索时有意义。

`RegExp.prototype.source`：返回正则表达式的字符串形式（不包括反斜杠），该属性只读。

**实例方法**

`RegExp.prototype.test()`：返回 true 或 false，表示正则表达式能否匹配指定字符串。如果正则表达式是一个空字符串(即当 `var r = RegExp('')` 时)，则匹配所有字符串。

如果正则表达式带有 g 修饰符，`lastIndex` 属性将保存上一次匹配成功结束的位置，则之后的每一次 test 方法都从 `lastIndex` 位置开始向后匹配。

带有 g 修饰符时，可以通过指定正则表达式的 `lastIndex` 属性来指定开始搜索的位置。

`lastIndex` 属性只对同一个正则表达式有效，对于一个新的正则表达式，`lastIndex` 总是等于0。

-------------------------------

`RegExp.prototype.exec()`：模式匹配成功，就返回一个数组，否则返回null。

如果匹配成功，**返回数组** 类似于 `["x_", "x_", index: 1, input: "_x_x", groups: undefined]`。它的解释如下：

索引为 0 的数组成员是匹配到的子字符串，；

索引为 1 的数组成员是**捕获组**匹配的字符串；

index 属性表示匹配成功的字符串的开始位置；

input 属性表示源字符串；

group 属性是一个对象，存放命名的捕获组。

**命名捕获组的语法是 `(?<name>...)`，即在普通的捕获组开头加上 `?<name>`**

如果正则表达式加上 **g 修饰符**，`lastIndex` 属性将保存上一次匹配成功结束的位置，这时再次使用 `exec()` 方法将从 `lastIndex` 位置开始向后匹配，这样使用循环就可以实现全局匹配。

lastIndex 属性不仅可读，而且可写。设置了g修饰符的时候，只要手动设置了 lastIndex 的值，就会从指定位置开始匹配。

**字符串的实例方法**

`String.prototype.match()`：返回一个数组，成员是所有匹配的子字符串。匹配成功返回一个数组，匹配失败返回null。如果正则表达式带有g修饰符，会一次性返回所有匹配成功的结果。
注意：设置正则表达式的lastIndex属性，对match方法无效，匹配总是从字符串的第一个字符开始。

`String.prototype.search()`：按照给定的正则表达式进行搜索，返回一个整数，表示匹配开始的位置。如果没有任何匹配，则返回-1。

`String.prototype.replace()`：接受两个参数，第一个是正则表达式，表示搜索模式，第二个是替换的内容。返回替换后的字符串。（不改变原字符串）

如果加 g 修饰符，替换所有匹配。一个应用，就是消除字符串首尾两端的空格。

replace方法的第二个参数可以使用美元符号$，用来指代所替换的内容：

`$&`：匹配的子字符串。

`$` &grave; ：匹配结果前面的文本。

`$'`：匹配结果后面的文本。

`$n`：匹配成功的第n组内容，n是从1开始的自然数。

`$$`：指代美元符号$。

replace方法的第二个参数还可以是一个函数，将每一个匹配内容替换为函数返回值。这个替换函数可以接受多个参数，第一个是捕捉到的内容，第二个是捕捉到的组匹配，此外，最后还可以添加两个参数，倒数第二个参数是捕捉到的内容在整个字符串中的位置（比如从第五个位置开始），最后一个参数是原字符串。

`String.prototype.split()`：按照给定规则进行字符串分割，返回一个数组，包含分割后的各个成员。第一个参数是正则表达式，表示分隔规则，第二个参数是返回数组的最大成员数。

**正则表达式模式**

简单模式：`/abc/` 匹配字符串 “abc”

特殊字符：

- 断言
  - 边界类断言
    - `^` 匹配输入的开头位置。开启多行模式后，换行符后的位置也被视为输入的开头位置。
    - `$` 匹配输入的结束位置。开始多行模式后，换行符前的位置也被视为输入的结束位置。
    - `\b` 匹配单词边界的位置。这个位置在一个单词与它前面或后面的空格之间。
    - `\B` 匹配非单词边界的位置。
  - 其他断言
    - `x(?=y)` 先行断言，x 后跟 y 时匹配 x。例如，对于 `/Jack(?=Sprat|Frost)/` “Jack”后跟有“Sprat”或“Frost”的情况下才会得到匹配。不过， 匹配结果不包括“Sprat”或“Frost”。
    - `x(?!y)` 先行否定断言。x 没有被 y 紧随时匹配 x 。例如，对于`/\d+(?!\.)/.exec(3.141)`，匹配‘141’而不是‘3’。
    - `(?<=y)x` 后行断言，x 跟随 y 的情况下匹配 x。
    - `(?<!y)x` 后行否定断言，x 不跟随 y 时匹配 x。
- 字符类
  - `.` 匹配除行终止符（`\n`, `\r`, `\u2028`, `\u2029`）外的任何字符。在 `字符集` 内，失去其特殊意义。ES2018 添加了 s "dotAll" 标志,它允许点也匹配行终止符。
  - `\d` 匹配任何数字，相当于 `[0-9]` 。
  - `\D` 匹配任何非数字(阿拉伯数字)的字符。相当于 `[^0-9]` 。
  - `\w` 匹配任何字母,数字,下划线。相当于 `[A-Za-z0-9_]` 。
  - `\W` 匹配任何非字母,数字,下划线。相当于 `[^A-Za-z0-9_]` 。
  - `\s` 匹配一个空白符，包括 space, tab, form feed, line feed 和其他 Unicode spaces。相当于 `[ \f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]` 。
  - `\S` 匹配一个非空白符。相当于 `[^ \f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]` 。
  - `\t` 匹配水平制表符。horizontal tab
  - `\r` 匹配回车符。
  - `\n` 匹配换行符。linefeed
  - `\v` 匹配垂直制表符。vertical tab
  - `\f` 匹配换页符。form feed
  - `[\b]` 匹配退格符。backspace
  - `\0` 匹配 NUL 字符。其后不能跟任何数字。
  - `\cX` 匹配一个控制字符。X 是字母 `A-Z` ，对应代码点 `U+0001 - U+001F` 。
  - `\xhh` 匹配两位十六进制表示的字符。
  - `uhhhh` 匹配四位十六进制表示的 UTF-16 代码单元。
  - `u{hhhh}` or `u{hhhhh}` （只有当 `u` 标志设置时）匹配对应的 Unicode 字符。
  - `\` 指示紧接的字符应该被特殊对待还是被转义。
- 分组和范围
- 量词
- 转义字符

预备知识：[海之殇](https://www.cnblogs.com/fuhai/p/6149169.html)
单词：javascript和java中正则表达式单词的定义是一样的，都是指由 `\w` 即 `[a-zA-Z0-9_]` 组成的字符串。例如：`THE MOON`
边界：边界是指一个位置，而不是某一个具体的字符，具体来说，就是每个字符之间以及字符串首尾的位置。如果用 `|` 来表示位置的话，那么字符串 `example:a+b=3` 就表示为 `|e|x|a|m|p|l|e|:|a|+|b|=|3|` 。
单词边界：`|example|:|a|+|b|=|3|` 。
非单词边界：`e|x|a|m|p|l|e:a+b=3` 。

